{namespace org.plovr autoescape="strict"}

/**
 * @param? moduleInfo
 * @param? moduleUris
 * @param filesAsJsonArray
 * @param path
 */
{template .raw kind="js"}
CLOSURE_NO_DEPS = true;
{if $moduleInfo}
PLOVR_MODULE_INFO={$moduleInfo};
{/if}
{if $moduleUris}
PLOVR_MODULE_URIS={$moduleUris};
{/if}
PLOVR_MODULE_USE_DEBUG_MODE=true;
(function() {lb}
{sp}{sp}var files = {$filesAsJsonArray};{\n}
{sp}{sp}var path = '{$path}';{\n}
{literal}
  var scriptEl;
  var doc = document;
  var scripts = doc.getElementsByTagName('script');
  for (var i = scripts.length - 1; i >= 0; --i) {
    var candidateScriptEl = scripts[i];
    var src = candidateScriptEl.src;
    if (src.indexOf(path) >= 0) {
      scriptEl = candidateScriptEl;
      break;
    }
  }

  if (!scriptEl) {
    return;
  }

  for (var i = 0; i < files.length; i++) {
    doc.write('<script type="text/javascript" src="' + files[i] + '"><\/script>');
  }
})();
{/literal}
{/template}

/**
 * @param src
 */
{template .loadRootModule kind="js"}
document.write('<script type="text/javascript" src="{$src}"><\/script>');
{/template}
